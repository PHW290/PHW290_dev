---
title: "Problem Set 6"
author: "NAME HERE"
date: "10/1/2020"
output: pdf_document
---

```{r}
library(tidyverse)
library(readr)

df <- read_csv("missingness_interventions.csv")
df <- readxl::read_xlsx("missingness_interventions.xlsx")
```

### Question 

There's a few inconsistencies with how NAs have been recorded in the gender and orienation column. We have blanks, -999, -1, and NA. Fix these inconsistencies by changing the value to NA.

How many NAs do we have in the entire data set?

```{r}
# check unique gender & orientation entries
unique(df$gender)
unique(df$orientation)

df <- df %>%
  mutate(gender = if_else(gender %in% c("female", "male"), # if female/male 
                          gender, # keep same
                          NA_character_), # otherwise, NA
         orientation = if_else(orientation %in% # check for:
                                 c("heterosexual", "lesbian/gay woman", "gay", "other"),
                              orientation, # keep same 
                              NA_character_)) # otherwise NA

# 25 NAs
sum(is.na(df))
```

\newpage

### Question

At a glance, we can already see errors with city and state names. Let's first fix these entries to have uniform naming where cities are properly capitalized and states are capitalized. For example, we want to see "San Antonio" and "TX" rather than "san Antonio" and "tx". We want you to use distinct(), pull(), and case_when() for this question.

```{r}
 # pull/look at unique city names
df %>%
  select(city) %>%
  distinct() %>%
  pull()

# pull/look at unique states 
df %>% 
  select(state) %>%
  distinct() %>%
  pull()

# fix city and state using case_when()
df <- df %>%
  mutate(
    city = case_when(
      city %in% c("Atlanta", "atlanta", "atlAnTa") ~ "Atlanta",
      city %in% c("Austin", "austin") ~ "Austin",
      city %in% c("San Antonio", "san Antonio") ~ "San Antonio",
      city %in% c("Oakland", "oakland", "iakland") ~ "Oakland",
      city %in% c("Hayward", "hayward", "Haywarf") ~ "Hayward"),
    state = case_when(
      state %in% c("GA", "gA", "ga", "G A") ~ "GA",
      state %in% c("TX", "tX", "tx") ~ "TX",
      state %in% c("CA", "ca", "C A", "CA_") ~ "CA"))
```

\newpage

### Question

Format the date column into a date format. Ominously, these interventions all occurred on the 25th day of the month.

```{r}
df$date <- dmy(df$date)
```


### Question

More errors! We see that some cities and states do not match appropriately. We can assume there were no errors with the date data. Use the following information to fix the state information. We know the interventions occurred in these cities during the following dates:

* 03/2018 - Oakland
* 03/2018 - Hayward
* 05/2018 - Atlanta
* 02/2019 - San Antonio
* 02/2019 - Austin

```{r}
df <- df %>% 
  mutate(state = case_when(
    date == as.Date("2018-03-25") ~ "CA",
    date == as.Date("2018-05-25") ~ "GA",
    date == as.Date("2019-02-25") ~ "TX"
  ))

# now fix city
df2 <- df %>%
  mutate(city = case_when(
    city 
  ))
```

### Question

Now we want to fix the city information, but you may realize that we have two cities in California during the same date. We can't, at least from our data, distinguish the difference. Let's drop those rows with this inconsitency. 

```{r}
df2 <- df %>%
  
```


How many observations do we have in each state?

