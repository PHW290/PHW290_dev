---
title: 'Problem Set #9 Solutions'
author: "Your Name"
date: "11/5/2020"
output: pdf_document
urlcolor: purple
---

For this problem set we will use data from [New York City](https://data.cityofnewyork.us/Health/Children-Under-6-yrs-with-Elevated-Blood-Lead-Leve/tnry-kwh5) that tested children under 6 years old for elevated blood lead levels (BLL). [You can read more about the data on their website]).

About the data:

All NYC children are required to be tested for lead poisoning at around age 1 and age 2, and to be screened for risk of lead poisoning, and tested if at risk, up until age 6. These data are an indicator of children younger that 6 years of age tested in NYC in a given year with blood lead levels of 5 mcg/dL or greater. In 2012, CDC established that a blood lead level of 5 mcg/dL is the reference level for exposure to lead in children. This level is used to identify children who have blood lead levels higher than most children's levels. The reference level is determined by measuring the NHANES blood lead distribution in US children ages 1 to 5 years, and is reviewed every 4 years.

1 - Bronx
2 - Brooklyn
3 - Manhattan
4 - Queens
5 - Staten Island

```{r loading include=F}
library(tidyverse)
bll_nyc <- read_csv("data/Children_Under_6_yrs_with_Elevated_Blood_Lead_Levels__BLL_.csv") %>% drop_na()
colnames(bll_nyc) <- c("borough_id", "time_period", 
                       "bll_5", "bll_10", "bll_15", "total_tested")
```

Before we start visualizing data, we want to calculate each BLL level (5, 10, 15) per 1,000 tested, rounded to one decmil place. Let's also drop any missing data (for the purposes of visualizing). 

```{r}




# %>%
#   mutate(bll_5_1000  = round(bll_5/total_tested * 1000, 1),
#          bll_10_1000 = round(bll_10/total_tested * 1000, 1),
#          bll_15_1000 = round(bll_15/total_tested * 1000, 1)) %>%
#   drop_na() # drop any missing data


```

1 - Bronx
2 - Brooklyn
3 - Manhattan
4 - Queens
5 - Staten Island

```{r}
bll_nyc_1 <- bll_nyc %>% 
  group_by(borough_id) %>%
  summarize(bll_all = sum(bll_5, bll_10, bll_15)) 

bll_nyc_1$borough_id <- factor(bll_nyc_1$borough_id,
                               levels = c("5","3","1","4","5"),
                               labels = c("Staten Island","Manhattan",
                                             "Bronx", "Queens", "Brooklyn"),
                                          ordered=TRUE)

ggplot(bll_nyc_1, aes(x = borough_id, y = bll_all)) +
  geom_col(fill = "orange") +
  labs(x = "boroughs",
       y = "counts of BLL > 5 Âµg/dL",
       title = "New York City: Elevated Blood Lead Levels 2006-2016 by Borough") +
  scale_x_discrete(labels=c("Bronx", "Brooklyn", "Manhattan", 
                            "Queens", "Staten Island")) +
  theme_bw()

```

```{r}
# comparing overall raes of lead levels by borough
ggplot(bll_nyc, aes(x = borough_id, y = bll_5_1k, fill = time_period)) +
  geom_col()
```


